@model HotelBookingSystem.ViewModels.Booking.BookingViewModel
@{
    ViewData["Title"] = "Đặt phòng";
}

@section Styles {
    <link rel="stylesheet" href="~/css/booking-simple.css" />
}

<div class="container my-4">
    <div class="row">
        <!-- Main Form Column -->
        <div class="col-lg-8">
            <!-- Page Header -->
            <div class="page-header mb-4">
                <h2 class="h3 mb-2">Đặt phòng khách sạn</h2>
                <p class="text-muted mb-3">Vui lòng điền đầy đủ thông tin để hoàn tất đặt phòng</p>

                <!-- Process Guide -->
                <div class="process-guide alert alert-info">
                    <h6 class="mb-2">
                        <i class="fas fa-info-circle me-2"></i>
                        Quy trình đặt phòng của chúng tôi
                    </h6>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="guide-step">
                                <strong>Bước 1:</strong> Điền thông tin lưu trú
                                <small class="d-block text-muted">Chọn ngày, số khách</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="guide-step">
                                <strong>Bước 2:</strong> Xác nhận thông tin cá nhân
                                <small class="d-block text-muted">Kiểm tra thông tin liên lạc</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="guide-step">
                                <strong>Bước 3:</strong> Thanh toán tại khách sạn
                                <small class="d-block text-muted">Thanh toán khi nhận phòng</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <form asp-action="Create" method="post" novalidate>
                <input type="hidden" asp-for="RoomId" />
                <input type="hidden" asp-for="RoomName" />
                <input type="hidden" asp-for="RoomType" />
                <input type="hidden" asp-for="RoomImageUrl" />
                <input type="hidden" asp-for="RoomPrice" />
                <input type="hidden" asp-for="MaxGuests" />

                <!-- 1. Thông tin lưu trú -->
                <div class="form-section">
                    <div class="section-header">
                        <h4 class="section-title">
                            <span class="step-number">1</span>
                            Thông tin lưu trú
                        </h4>
                        <div class="section-info">
                            <small class="text-muted">
                                <i class="fas fa-calendar-alt me-1"></i>
                                Thời gian nhận phòng: 14:00 | Trả phòng: 12:00
                            </small>
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="CheckInDate" class="form-label">
                                    Ngày nhận phòng
                                    <span class="text-danger">*</span>
                                </label>
                                <input asp-for="CheckInDate" type="date" class="form-control" required />
                                <div class="form-text">
                                    <i class="fas fa-info-circle me-1"></i>
                                    Nhận phòng từ 14:00
                                </div>
                                <span asp-validation-for="CheckInDate" class="text-danger small"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="CheckOutDate" class="form-label">
                                    Ngày trả phòng
                                    <span class="text-danger">*</span>
                                </label>
                                <input asp-for="CheckOutDate" type="date" class="form-control" required />
                                <div class="form-text">
                                    <i class="fas fa-info-circle me-1"></i>
                                    Trả phòng trước 12:00
                                </div>
                                <span asp-validation-for="CheckOutDate" class="text-danger small"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="GuestCount" class="form-label">
                                    Số khách
                                    <span class="text-danger">*</span>
                                </label>
                                <select asp-for="GuestCount" class="form-select" required>
                                    <option value="">Chọn số khách</option>
                                    @for (int i = 1; i <= Model.MaxGuests; i++)
                                    {
                                        <option value="@i">@i khách</option>
                                    }
                                </select>
                                <div class="form-text">
                                    <i class="fas fa-users me-1"></i>
                                    Sức chứa tối đa: <span id="max-guests">@Model.MaxGuests</span> khách
                                </div>
                                <span asp-validation-for="GuestCount" class="text-danger small"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="SpecialRequests" class="form-label">Yêu cầu đặc biệt</label>
                                <textarea asp-for="SpecialRequests" class="form-control" rows="3"
                                    placeholder="VD: Phòng tầng cao, giường đôi, gần thang máy..."></textarea>
                                <div class="form-text">
                                    <i class="fas fa-lightbulb me-1"></i>
                                    Chúng tôi sẽ cố gắng đáp ứng yêu cầu của bạn (không bảo đảm)
                                </div>
                                <span asp-validation-for="SpecialRequests" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. Thông tin khách hàng -->
                <div class="form-section">
                    <div class="section-header">
                        <h4 class="section-title">
                            <span class="step-number">2</span>
                            Thông tin khách hàng
                        </h4>
                        <div class="section-info">
                            <small class="text-muted">
                                <i class="fas fa-shield-alt me-1"></i>
                                Thông tin được bảo mật và chỉ dùng cho việc liên lạc
                            </small>
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            Thông tin được lấy từ hồ sơ của bạn.
                            <a href="/Account/Profile" class="alert-link">Cập nhật thông tin</a> nếu cần thiết.
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="FirstName" class="form-label">
                                    Tên <span class="text-danger">*</span>
                                </label>
                                <input asp-for="FirstName" class="form-control" readonly />
                                <div class="form-text">
                                    <i class="fas fa-lock me-1"></i>
                                    Thông tin từ tài khoản của bạn
                                </div>
                                <span asp-validation-for="FirstName" class="text-danger small"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="LastName" class="form-label">
                                    Họ <span class="text-danger">*</span>
                                </label>
                                <input asp-for="LastName" class="form-control" readonly />
                                <div class="form-text">
                                    <i class="fas fa-edit me-1"></i>
                                    <a href="/Account/Profile" class="text-decoration-none">Cập nhật thông tin</a>
                                </div>
                                <span asp-validation-for="LastName" class="text-danger small"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="Email" class="form-label">
                                    Email <span class="text-danger">*</span>
                                </label>
                                <input asp-for="Email" type="email" class="form-control" readonly />
                                <div class="form-text">
                                    <i class="fas fa-envelope me-1"></i>
                                    Email xác nhận đặt phòng sẽ được gửi đến địa chỉ này
                                </div>
                                <span asp-validation-for="Email" class="text-danger small"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="Phone" class="form-label">
                                    Số điện thoại <span class="text-danger">*</span>
                                </label>
                                <input asp-for="Phone" class="form-control" readonly />
                                <div class="form-text">
                                    <i class="fas fa-phone me-1"></i>
                                    Dùng để liên lạc khẩn cấp khi cần thiết
                                </div>
                                <span asp-validation-for="Phone" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. Phương thức thanh toán -->
                <div class="form-section">
                    <div class="section-header">
                        <h4 class="section-title">
                            <span class="step-number">3</span>
                            Phương thức thanh toán
                        </h4>
                        <div class="section-info">
                            <small class="text-muted">
                                <i class="fas fa-credit-card me-1"></i>
                                Thanh toán an toàn và thuận tiện
                            </small>
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="alert alert-success">
                            <h6 class="mb-2">
                                <i class="fas fa-money-bill-wave me-2"></i>
                                Thanh toán tiền mặt tại khách sạn
                            </h6>
                            <ul class="mb-0 ps-3">
                                <li>Thanh toán khi nhận phòng (check-in)</li>
                                <li>Không cần trả trước hay đặt cọc</li>
                                <li>Chấp nhận tiền Việt Nam Đồng (VNĐ)</li>
                                <li>Nhận hóa đơn VAT đầy đủ</li>
                            </ul>
                        </div>
                        <div class="payment-methods-simple">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                Đặt phòng của bạn sẽ được giữ trong 24 giờ mà không cần thanh toán trước
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="radio" name="PaymentMethod" id="cash" value="Cash"
                                    checked readonly>
                                <label class="form-check-label" for="cash">
                                    <i class="fas fa-money-bill-wave me-2 text-success"></i>
                                    <strong>Thanh toán tiền mặt tại khách sạn</strong>
                                    <br>
                                    <small class="text-muted">Thanh toán khi nhận phòng (Check-in: 14:00)</small>
                                </label>
                            </div>
                            <input type="hidden" name="PaymentMethod" value="Cash" />
                        </div>
                    </div>
                </div>

                <!-- 4. Điều khoản và đặt phòng -->
                <div class="form-section">
                    <div class="section-header">
                        <h4 class="section-title">
                            <span class="step-number">4</span>
                            Xác nhận đặt phòng
                        </h4>
                        <div class="section-info">
                            <small class="text-muted">
                                <i class="fas fa-clipboard-check me-1"></i>
                                Xem lại thông tin và hoàn tất đặt phòng
                            </small>
                        </div>
                    </div>
                    <div class="section-content">
                        <!-- Booking Summary Info -->
                        <div class="alert alert-light border">
                            <h6 class="mb-3">
                                <i class="fas fa-bookmark me-2"></i>
                                Sau khi đặt phòng thành công:
                            </h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="list-unstyled mb-0">
                                        <li class="mb-2">
                                            <i class="fas fa-envelope text-primary me-2"></i>
                                            Email xác nhận sẽ được gửi ngay lập tức
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-phone text-success me-2"></i>
                                            Hotline hỗ trợ 24/7: <strong>1900 1234</strong>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul class="list-unstyled mb-0">
                                        <li class="mb-2">
                                            <i class="fas fa-calendar-check text-info me-2"></i>
                                            Có thể hủy miễn phí trước 6 giờ nhận phòng
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-gift text-warning me-2"></i>
                                            Tích điểm thành viên với mỗi lần lưu trú
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="terms-agreement mb-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="terms" required>
                                <label class="form-check-label" for="terms">
                                    Tôi đồng ý với
                                    <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal"
                                        class="text-decoration-none">
                                        Điều khoản và Điều kiện
                                    </a>
                                    của khách sạn <span class="text-danger">*</span>
                                </label>
                            </div>
                            <small class="form-text text-muted mt-1">
                                <i class="fas fa-shield-alt me-1"></i>
                                Thông tin của bạn được bảo vệ theo chính sách bảo mật của chúng tôi
                            </small>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-outline-secondary me-3" onclick="history.back()">
                                <i class="fas fa-arrow-left me-2"></i>Quay lại
                            </button>
                            <button type="submit" class="btn btn-primary btn-lg" id="submitBtn" disabled>
                                <i class="fas fa-check me-2"></i>Xác nhận đặt phòng
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <div class="booking-summary-card">
                <h5 class="summary-title">
                    <i class="fas fa-clipboard-list me-2"></i>
                    Thông tin đặt phòng
                </h5>

                <!-- Room Info -->
                <div class="room-info mb-4">
                    <img src="@Model.RoomImageUrl" alt="@Model.RoomName" class="room-image">
                    <div class="room-details">
                        <h6 class="room-name">@Model.RoomName</h6>
                        <p class="room-type mb-1">@Model.RoomType</p>
                        <small class="text-muted">
                            <i class="fas fa-users me-1"></i>
                            Tối đa @Model.MaxGuests khách
                        </small>
                    </div>
                </div>

                <!-- Booking Details -->
                <div class="booking-details">
                    <div class="detail-row">
                        <span>
                            <i class="fas fa-sign-in-alt me-1 text-success"></i>
                            Ngày nhận phòng:
                        </span>
                        <span id="display-checkin">Chưa chọn</span>
                    </div>
                    <div class="detail-row">
                        <span>
                            <i class="fas fa-sign-out-alt me-1 text-warning"></i>
                            Ngày trả phòng:
                        </span>
                        <span id="display-checkout">Chưa chọn</span>
                    </div>
                    <div class="detail-row">
                        <span>
                            <i class="fas fa-moon me-1 text-info"></i>
                            Số đêm:
                        </span>
                        <span id="display-nights">0</span>
                    </div>
                    <div class="detail-row">
                        <span>
                            <i class="fas fa-users me-1 text-primary"></i>
                            Số khách:
                        </span>
                        <span id="display-guests">Chưa chọn</span>
                    </div>
                    <hr>
                    <div class="detail-row">
                        <span>
                            <i class="fas fa-tag me-1 text-success"></i>
                            Giá phòng/đêm:
                        </span>
                        <span data-room-price="@Model.RoomPrice">@Model.RoomPrice.ToString("N0") VNĐ</span>
                    </div>
                    <div class="detail-row total-row">
                        <span>
                            <strong>
                                <i class="fas fa-calculator me-1"></i>
                                Tổng cộng:
                            </strong>
                        </span>
                        <span><strong id="display-total">0 VNĐ</strong></span>
                    </div>
                </div>

                <!-- Policy Info -->
                <div class="policy-info mb-3">
                    <h6 class="mb-2">
                        <i class="fas fa-info-circle me-2 text-info"></i>
                        Chính sách khách sạn
                    </h6>
                    <ul class="small mb-0 ps-3">
                        <li>Miễn phí hủy phòng trước 6 giờ</li>
                        <li>Không phụ thu cho trẻ em dưới 6 tuổi</li>
                        <li>Wifi miễn phí toàn bộ khách sạn</li>
                        <li>Bãi đỗ xe miễn phí</li>
                    </ul>
                </div>

                <!-- Support -->
                <div class="support-info">
                    <div class="text-center">
                        <i class="fas fa-headset text-primary mb-2" style="font-size: 24px;"></i>
                        <p class="mb-1">
                            <strong>Cần hỗ trợ?</strong>
                        </p>
                        <p class="mb-0">
                            <strong>Hotline: 1900 1234</strong><br>
                            <small class="text-muted">Hỗ trợ 24/7 - Miễn phí</small>
                        </p>
                        <small class="text-muted d-block mt-2">
                            <i class="fas fa-envelope me-1"></i>
                            support@hotel.com
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Terms Modal -->
<div class="modal fade" id="termsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Điều khoản và Điều kiện</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <h6>1. Điều kiện đặt phòng</h6>
                <p>- Khách hàng phải từ 18 tuổi trở lên để đặt phòng</p>
                <p>- Thông tin đặt phòng phải chính xác và đầy đủ</p>

                <h6>2. Chính sách hủy phòng</h6>
                <p>- Hủy phòng trước 24h: Hoàn tiền 100%</p>
                <p>- Hủy phòng trong vòng 24h: Tính phí 50% tổng hóa đơn</p>

                <h6>3. Chính sách thanh toán</h6>
                <p>- Thanh toán khi nhận phòng</p>
                <p>- Chấp nhận tiền mặt, thẻ tín dụng, chuyển khoản</p>

                <h6>4. Quy định khách sạn</h6>
                <p>- Giờ nhận phòng: 14:00 | Giờ trả phòng: 12:00</p>
                <p>- Không hút thuốc trong phòng</p>
                <p>- Không được mang thú cưng</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/booking-simple.js"></script>
}
