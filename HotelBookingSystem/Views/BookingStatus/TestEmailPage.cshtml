@{
    ViewData["Title"] = "Test Email Notifications";
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <h2>üîß Test Email Notifications</h2>
            <p class="text-muted">Trang n√†y d√πng ƒë·ªÉ test c√°c ch·ª©c nƒÉng g·ª≠i email th√¥ng b√°o thay ƒë·ªïi tr·∫°ng th√°i ƒë·∫∑t ph√≤ng v√† thanh to√°n.</p>
        </div>
    </div>

    <div class="row">
        <!-- Update Booking Status -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5><i class="fas fa-bed"></i> Thay ƒë·ªïi tr·∫°ng th√°i ƒë·∫∑t ph√≤ng</h5>
                </div>
                <div class="card-body">
                    <form id="updateBookingStatusForm">
                        <div class="mb-3">
                            <label for="bookingId1" class="form-label">Booking ID:</label>
                            <input type="number" class="form-control" id="bookingId1" name="bookingId" placeholder="Nh·∫≠p ID ƒë·∫∑t ph√≤ng" required>
                        </div>
                        <div class="mb-3">
                            <label for="newStatusId" class="form-label">Tr·∫°ng th√°i m·ªõi:</label>
                            <select class="form-control" id="newStatusId" name="newStatusId" required>
                                <option value="">-- Ch·ªçn tr·∫°ng th√°i --</option>
                                <option value="1">Pending (Ch·ªù x·ª≠ l√Ω)</option>
                                <option value="2">Confirmed (ƒê√£ x√°c nh·∫≠n)</option>
                                <option value="3">Cancelled (ƒê√£ h·ªßy)</option>
                                <option value="4">Completed (Ho√†n th√†nh)</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="reason1" class="form-label">L√Ω do (t√πy ch·ªçn):</label>
                            <textarea class="form-control" id="reason1" name="reason" rows="2" placeholder="Nh·∫≠p l√Ω do thay ƒë·ªïi"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-envelope"></i> C·∫≠p nh·∫≠t & G·ª≠i Email
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Update Payment Status -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5><i class="fas fa-credit-card"></i> Thay ƒë·ªïi tr·∫°ng th√°i thanh to√°n</h5>
                </div>
                <div class="card-body">
                    <form id="updatePaymentStatusForm">
                        <div class="mb-3">
                            <label for="bookingId2" class="form-label">Booking ID:</label>
                            <input type="number" class="form-control" id="bookingId2" name="bookingId" placeholder="Nh·∫≠p ID ƒë·∫∑t ph√≤ng" required>
                        </div>
                        <div class="mb-3">
                            <label for="newPaymentStatusId" class="form-label">Tr·∫°ng th√°i thanh to√°n m·ªõi:</label>
                            <select class="form-control" id="newPaymentStatusId" name="newPaymentStatusId" required>
                                <option value="">-- Ch·ªçn tr·∫°ng th√°i thanh to√°n --</option>
                                <option value="1">Pending (Ch·ªù thanh to√°n)</option>
                                <option value="2">Paid (ƒê√£ thanh to√°n)</option>
                                <option value="3">Failed (Th·∫•t b·∫°i)</option>
                                <option value="4">Refunded (ƒê√£ ho√†n ti·ªÅn)</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="reason2" class="form-label">L√Ω do (t√πy ch·ªçn):</label>
                            <textarea class="form-control" id="reason2" name="reason" rows="2" placeholder="Nh·∫≠p l√Ω do thay ƒë·ªïi"></textarea>
                        </div>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-envelope"></i> C·∫≠p nh·∫≠t & G·ª≠i Email
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <!-- Cancel Booking -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header bg-danger text-white">
                    <h5><i class="fas fa-times"></i> H·ªßy ƒë·∫∑t ph√≤ng</h5>
                </div>
                <div class="card-body">
                    <form id="cancelBookingForm">
                        <div class="mb-3">
                            <label for="bookingId3" class="form-label">Booking ID:</label>
                            <input type="number" class="form-control" id="bookingId3" name="bookingId" placeholder="Nh·∫≠p ID ƒë·∫∑t ph√≤ng" required>
                        </div>
                        <div class="mb-3">
                            <label for="cancelReason" class="form-label">L√Ω do h·ªßy:</label>
                            <textarea class="form-control" id="cancelReason" name="reason" rows="3" placeholder="Nh·∫≠p l√Ω do h·ªßy ƒë·∫∑t ph√≤ng" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-danger">
                            <i class="fas fa-envelope"></i> H·ªßy & G·ª≠i Email
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Check-in Reminder -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5><i class="fas fa-clock"></i> Nh·∫Øc nh·ªü check-in</h5>
                </div>
                <div class="card-body">
                    <form id="checkInReminderForm">
                        <div class="mb-3">
                            <label for="bookingId4" class="form-label">Booking ID:</label>
                            <input type="number" class="form-control" id="bookingId4" name="bookingId" placeholder="Nh·∫≠p ID ƒë·∫∑t ph√≤ng" required>
                        </div>
                        <div class="mb-3">
                            <small class="text-muted">G·ª≠i email nh·∫Øc nh·ªü kh√°ch h√†ng v·ªÅ l·ªãch check-in s·∫Øp t·ªõi.</small>
                        </div>
                        <button type="submit" class="btn btn-info">
                            <i class="fas fa-envelope"></i> G·ª≠i Email Nh·∫Øc Nh·ªü
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Payment Reminder -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header bg-warning text-dark">
                    <h5><i class="fas fa-exclamation-triangle"></i> Nh·∫Øc nh·ªü thanh to√°n</h5>
                </div>
                <div class="card-body">
                    <form id="paymentReminderForm">
                        <div class="mb-3">
                            <label for="bookingId5" class="form-label">Booking ID:</label>
                            <input type="number" class="form-control" id="bookingId5" name="bookingId" placeholder="Nh·∫≠p ID ƒë·∫∑t ph√≤ng" required>
                        </div>
                        <div class="mb-3">
                            <small class="text-muted">G·ª≠i email nh·∫Øc nh·ªü kh√°ch h√†ng ho√†n t·∫•t thanh to√°n.</small>
                        </div>
                        <button type="submit" class="btn btn-warning text-dark">
                            <i class="fas fa-envelope"></i> G·ª≠i Email Nh·∫Øc Nh·ªü
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-12">
            <div class="alert alert-info">
                <h5><i class="fas fa-info-circle"></i> L∆∞u √Ω:</h5>
                <ul>
                    <li>T·∫•t c·∫£ email s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn c·∫£ kh√°ch h√†ng v√† kh√°ch s·∫°n (annthe176161@fpt.edu.vn)</li>
                    <li>Email kh√°ch h√†ng s·∫Ω c√≥ template ƒë·∫πp v·ªõi m√†u s·∫Øc ph√π h·ª£p</li>
                    <li>Email kh√°ch s·∫°n s·∫Ω c√≥ th√¥ng tin chi ti·∫øt ƒë·ªÉ x·ª≠ l√Ω</li>
                    <li>Ki·ªÉm tra console log ƒë·ªÉ xem th√¥ng tin chi ti·∫øt</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
    // Update Booking Status
    $('#updateBookingStatusForm').on('submit', function(e) {
        e.preventDefault();
        const bookingId = $('#bookingId1').val();
        const newStatusId = $('#newStatusId').val();
        const reason = $('#reason1').val();
        
        $.post('/BookingStatus/UpdateBookingStatus', {
            bookingId: bookingId,
            newStatusId: newStatusId,
            reason: reason
        })
        .done(function(response) {
            if (response.success) {
                alert('‚úÖ ' + response.message);
                $('#updateBookingStatusForm')[0].reset();
            } else {
                alert('‚ùå ' + response.message);
            }
        })
        .fail(function() {
            alert('‚ùå C√≥ l·ªói x·∫£y ra khi g·ª≠i y√™u c·∫ßu');
        });
    });

    // Update Payment Status
    $('#updatePaymentStatusForm').on('submit', function(e) {
        e.preventDefault();
        const bookingId = $('#bookingId2').val();
        const newPaymentStatusId = $('#newPaymentStatusId').val();
        const reason = $('#reason2').val();
        
        $.post('/BookingStatus/UpdatePaymentStatus', {
            bookingId: bookingId,
            newPaymentStatusId: newPaymentStatusId,
            reason: reason
        })
        .done(function(response) {
            if (response.success) {
                alert('‚úÖ ' + response.message);
                $('#updatePaymentStatusForm')[0].reset();
            } else {
                alert('‚ùå ' + response.message);
            }
        })
        .fail(function() {
            alert('‚ùå C√≥ l·ªói x·∫£y ra khi g·ª≠i y√™u c·∫ßu');
        });
    });

    // Cancel Booking
    $('#cancelBookingForm').on('submit', function(e) {
        e.preventDefault();
        const bookingId = $('#bookingId3').val();
        const reason = $('#cancelReason').val();
        
        if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën h·ªßy ƒë·∫∑t ph√≤ng n√†y?')) {
            $.post('/BookingStatus/CancelBooking', {
                bookingId: bookingId,
                reason: reason
            })
            .done(function(response) {
                if (response.success) {
                    alert('‚úÖ ' + response.message);
                    $('#cancelBookingForm')[0].reset();
                } else {
                    alert('‚ùå ' + response.message);
                }
            })
            .fail(function() {
                alert('‚ùå C√≥ l·ªói x·∫£y ra khi g·ª≠i y√™u c·∫ßu');
            });
        }
    });

    // Check-in Reminder
    $('#checkInReminderForm').on('submit', function(e) {
        e.preventDefault();
        const bookingId = $('#bookingId4').val();
        
        $.post('/BookingStatus/SendCheckInReminder', {
            bookingId: bookingId
        })
        .done(function(response) {
            if (response.success) {
                alert('‚úÖ ' + response.message);
                $('#checkInReminderForm')[0].reset();
            } else {
                alert('‚ùå ' + response.message);
            }
        })
        .fail(function() {
            alert('‚ùå C√≥ l·ªói x·∫£y ra khi g·ª≠i y√™u c·∫ßu');
        });
    });

    // Payment Reminder
    $('#paymentReminderForm').on('submit', function(e) {
        e.preventDefault();
        const bookingId = $('#bookingId5').val();
        
        $.post('/BookingStatus/SendPaymentReminder', {
            bookingId: bookingId
        })
        .done(function(response) {
            if (response.success) {
                alert('‚úÖ ' + response.message);
                $('#paymentReminderForm')[0].reset();
            } else {
                alert('‚ùå ' + response.message);
            }
        })
        .fail(function() {
            alert('‚ùå C√≥ l·ªói x·∫£y ra khi g·ª≠i y√™u c·∫ßu');
        });
    });
});
</script>
